#the ai Model
from re import split
from cs50 import SQL
import os
from replit import db
import sounddevice as sd
from scipy.io.wavfile import write
import time
import wavio as wv
import random
from replit.audio import InvalidFileType
import speech_recognition as sr

sr.__version__
def recognize_speech():
  audioo = ('')
  attempts = 0
  while audioo == ('') and attempts < 3:
    attempts = 0
    Recognise = sr.Recognizer()
    aud_file = input('Please enter your file: ')
    with sr.AudioFile(aud_file) as source:
      print("Recognising..")
      aud = Recognise.record(source, duration=10)
      Recognise.adjust_for_ambient_noise(source)
    try:
      audioo = Recognise.recognize_google(aud)
      print("You said:", audioo)
      if audioo == '':
        print('There is no input detected')
      else:
        print('There is an input')
      if attempts < 2:
        print('Please try again')
      return (audioo)
    except sr.UnknownValueError:
      print("Sorry, could not understand audio and Please Try Again.")
    except sr.RequestError as e:
      print(f"Error with the recognition service; {e}")
    attempts += 1
    print(attempts)
print(os.getenv("REPLIT_DB_URL"))

if __name__ == "__main__":
  recognize_speech()
db = SQL("sqlite:///database.db")

# database creation
def database_creation():
  db.execute(
      "CREATE TABLE IF NOT EXISTS Mai ( Name TEXT, Year_grp     INTEGER,Form TEXT,Voice_sample TEXT,Word TEXT,Signed_in       TEXT)"
  )
  db.execute(
      "INSERT OR REPLACE INTO Mai  (             Name,Year_grp,Form,Voice_sample,Word,Signed_in) VALUES(?,     ?,?,?,?,?)",
      'Akarsh', 13, '13R', 'Yes', 'gold', 'No')
  db.execute(
      "INSERT OR REPLACE INTO Mai  (                     Name,Year_grp,Form,Voice_sample,Word,Signed_in) VALUES(?,     ?,?,?,?,?)",
      'Sachin', 11, '10K', 'Yes', '', 'No')
  db.execute(
      "INSERT OR REPLACE INTO Mai (   Name,Year_grp,Form,Voice_sample,Word,Signed_in) VALUES(?,      ?,?,?,?,?)",
      'Haran', 9, '9K', 'Yes', '', 'No')


School_data = db.execute("SELECT DISTINCT Word FROM Mai")
    
